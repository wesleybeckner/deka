
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.4">
    
    
      
        <title>Finding More Patterns - Deka</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bb3983ee.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra.css">
    
      <link rel="stylesheet" href="../../styles.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-114664473-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#stock-cutting-part-2-finding-good-but-not-best-patterns" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Deka" class="md-header__button md-logo" aria-label="Deka" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Deka
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Finding More Patterns
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Deka" class="md-nav__button md-logo" aria-label="Deka" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Deka
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Solutions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Solutions" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Solutions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SOLN_P1_Stock_Cutting/" class="md-nav__link">
        The Knapsack Problem
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Finding More Patterns
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Finding More Patterns
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#10-import-functions-and-libraries" class="md-nav__link">
    1.0: Import Functions and Libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-modifications-from-knapsack-to-cutting-stock" class="md-nav__link">
    1.1 Modifications from knapsack to cutting stock
  </a>
  
    <nav class="md-nav" aria-label="1.1 Modifications from knapsack to cutting stock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-can-we-simplify-the-knapsack-function" class="md-nav__link">
    1.1.1 Can we simplify the knapsack function?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-1-replace-wt-and-val-in-knapsack-and-nonetype-in-initt" class="md-nav__link">
    ðŸŽ’ Exercise 1: replace wt and val in knapsack and nonetype in initt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112-how-many-slit-widths" class="md-nav__link">
    1.1.2 How many slit widths?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-call-knapsack-with-a-modified-list-of-widths" class="md-nav__link">
    ðŸŽ’ Exercise 2: call knapsack with a modified list of widths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-report-the-loss" class="md-nav__link">
    ðŸŽ’ Exercise 3: report the loss
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-why-good-but-not-best" class="md-nav__link">
    1.2: Why good but not best?
  </a>
  
    <nav class="md-nav" aria-label="1.2: Why good but not best?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-find-all-unique-combinations-of-slit-widths" class="md-nav__link">
    1.2.1 Find all unique combinations of slit widths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-permutate-the-list-of-unique-widths" class="md-nav__link">
    ðŸŽ’ Exercise 4: permutate the list of unique widths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-more-permutations" class="md-nav__link">
    1.2.2 More permutations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SOLN_P3_Stock_Cutting/" class="md-nav__link">
        The Column Generation Method
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Exercises
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Exercises" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Exercises
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../exercises/P1_Stock_Cutting/" class="md-nav__link">
        The Knapsack Problem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../exercises/P2_Stock_Cutting/" class="md-nav__link">
        Finding More Patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../exercises/P3_Stock_Cutting/" class="md-nav__link">
        The Column Generation Method
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#10-import-functions-and-libraries" class="md-nav__link">
    1.0: Import Functions and Libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-modifications-from-knapsack-to-cutting-stock" class="md-nav__link">
    1.1 Modifications from knapsack to cutting stock
  </a>
  
    <nav class="md-nav" aria-label="1.1 Modifications from knapsack to cutting stock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-can-we-simplify-the-knapsack-function" class="md-nav__link">
    1.1.1 Can we simplify the knapsack function?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-1-replace-wt-and-val-in-knapsack-and-nonetype-in-initt" class="md-nav__link">
    ðŸŽ’ Exercise 1: replace wt and val in knapsack and nonetype in initt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112-how-many-slit-widths" class="md-nav__link">
    1.1.2 How many slit widths?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-call-knapsack-with-a-modified-list-of-widths" class="md-nav__link">
    ðŸŽ’ Exercise 2: call knapsack with a modified list of widths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-report-the-loss" class="md-nav__link">
    ðŸŽ’ Exercise 3: report the loss
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-why-good-but-not-best" class="md-nav__link">
    1.2: Why good but not best?
  </a>
  
    <nav class="md-nav" aria-label="1.2: Why good but not best?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-find-all-unique-combinations-of-slit-widths" class="md-nav__link">
    1.2.1 Find all unique combinations of slit widths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-permutate-the-list-of-unique-widths" class="md-nav__link">
    ðŸŽ’ Exercise 4: permutate the list of unique widths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-more-permutations" class="md-nav__link">
    1.2.2 More permutations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<p><a href="https://colab.research.google.com/github/wesleybeckner/deka/blob/main/notebooks/solutions/SOLN_P2_Stock_Cutting.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<h1 id="stock-cutting-part-2-finding-good-but-not-best-patterns">Stock Cutting Part 2:<br> Finding Good (But not Best) Patterns<a class="headerlink" href="#stock-cutting-part-2-finding-good-but-not-best-patterns" title="Permanent link">&para;</a></h1>
<p><br></p>
<hr />
<p><br></p>
<p>In this project notebook we'll be leveraging our solution to the knapsack problem to create viable patterns for stock cutting.</p>
<p><br></p>
<hr />
<h2 id="10-import-functions-and-libraries">1.0: Import Functions and Libraries<a class="headerlink" href="#10-import-functions-and-libraries" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="k">def</span> <span class="nf">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">knapsack</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="c1"># n, w will be the row, column of our table</span>
    <span class="c1"># solve the basecase. </span>
    <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">elif</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

    <span class="c1"># now include the conditionals</span>
    <span class="k">if</span> <span class="n">wt</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">w</span><span class="p">:</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="n">knapsack</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
            <span class="n">knapsack</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">w</span><span class="o">-</span><span class="n">wt</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">val</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">wt</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">w</span><span class="p">:</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">wt</span><span class="p">):</span>
    <span class="n">recon</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">W</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">recon</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">wt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="c1"># move columns in table lookup</span>
        <span class="k">if</span> <span class="n">W</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
    <span class="k">return</span> <span class="n">recon</span>

<span class="k">def</span> <span class="nf">test_small_bag</span><span class="p">():</span>
    <span class="c1"># the problem parameters</span>
    <span class="n">val</span> <span class="o">=</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
    <span class="n">wt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">W</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="c1"># the known solution</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="n">max_items</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
    <span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>

    <span class="k">assert</span> <span class="n">best</span> <span class="o">==</span> <span class="n">max_val</span><span class="p">,</span> <span class="s2">&quot;Optimal value not found&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal value found&quot;</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="n">max_items</span><span class="p">,</span> <span class="s2">&quot;Optimal items not found&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal items found&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_val_weight_equality</span><span class="p">():</span>
    <span class="c1"># the problem parameters</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">wt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">W</span> <span class="o">=</span> <span class="mi">14</span>

    <span class="c1"># the known solution</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="mi">14</span>
    <span class="n">max_items</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
    <span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>

    <span class="k">assert</span> <span class="n">best</span> <span class="o">==</span> <span class="n">max_val</span><span class="p">,</span> <span class="s2">&quot;Optimal value not found&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal value found&quot;</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">pattern</span> <span class="o">==</span> <span class="n">max_items</span><span class="p">,</span> <span class="s2">&quot;Optimal items not found&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal items found&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">test_small_bag</span><span class="p">()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Optimal value found
Optimal items found
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">test_val_weight_equality</span><span class="p">()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Optimal value found
Optimal items found
</code></pre></div>

<h2 id="11-modifications-from-knapsack-to-cutting-stock">1.1 Modifications from knapsack to cutting stock<a class="headerlink" href="#11-modifications-from-knapsack-to-cutting-stock" title="Permanent link">&para;</a></h2>
<p>You may have guessed this, but for all of our problems the <code>wt</code> list and <code>val</code> list will always be the same; they will be the list of widths scheduled to cut from stock. </p>
<p>When we get our orders, we will need to adjust such that we are solving the <em>appropriate</em> problem with the knapsack function. To give an example, we might have 100 orders to fulfill with slitwidth 170. However we can max only fit 20 on a roll. In this situation, we don't want to include all 100 repeat widths in the knapsack problem, because we know we can't possibly fit that many. Instead, we want to only provide the maximum number of 170's we could possibly fit on a roll. This will make the algorithm more efficient.</p>
<h3 id="111-can-we-simplify-the-knapsack-function">1.1.1 Can we simplify the knapsack function?<a class="headerlink" href="#111-can-we-simplify-the-knapsack-function" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">wt</span> <span class="o">=</span> <span class="n">val</span> <span class="o">=</span> <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">320</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>
<span class="n">pattern</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Counter({170: 1, 280: 1, 320: 1})
</code></pre></div>

<h3 id="exercise-1-replace-wt-and-val-in-knapsack-and-nonetype-in-initt">ðŸŽ’ Exercise 1: replace wt and val in <code>knapsack</code> and nonetype in <code>initt</code><a class="headerlink" href="#exercise-1-replace-wt-and-val-in-knapsack-and-nonetype-in-initt" title="Permanent link">&para;</a></h3>
<p>Notice how in the above cell we set <code>wt</code> and <code>val</code> equal to our product widths. In the cell below, rewrite the <code>knapsack</code> function so that <code>widths</code> takes the place of both <code>wt</code> and <code>val</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="c1"># n, w will be the row, column of our table</span>
    <span class="c1"># solve the basecase. </span>
    <span class="k">if</span> <span class="n">w</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">elif</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

    <span class="c1"># now include the conditionals</span>
    <span class="k">if</span> <span class="n">widths</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">w</span><span class="p">:</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
            <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">w</span><span class="o">-</span><span class="n">widths</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">widths</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">widths</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">w</span><span class="p">:</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
</code></pre></div>

<p>Do the same thing for the <code>reconstruct</code> function. And while we're at it, let's change <code>N</code> to <code>n</code> and <code>W</code> to <code>w</code> so that our variables are consistent across both functions</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">widths</span><span class="p">):</span>
    <span class="n">recon</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">recon</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">-=</span> <span class="n">widths</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="c1"># move columns in table lookup</span>
        <span class="k">if</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
    <span class="k">return</span> <span class="n">recon</span>
</code></pre></div>

<p>and lets test our new functions</p>
<div class="codehilite"><pre><span></span><code><span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">320</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">widths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>
<span class="n">pattern</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Counter({170: 1, 280: 1, 320: 1})
</code></pre></div>

<h3 id="112-how-many-slit-widths">1.1.2 How many slit widths?<a class="headerlink" href="#112-how-many-slit-widths" title="Permanent link">&para;</a></h3>
<p>Does our answer to the knapsack problem above make sense? It does based on what we fed the function. However, in reality what we're looking for is the best pattern given a list of unique slit widths even if that requires repeating units of slit widths. So how do we modify the way we call the function?</p>
<div class="codehilite"><pre><span></span><code><span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">320</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">widths</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">([</span><span class="n">w</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">W</span><span class="o">/</span><span class="n">w</span><span class="p">))</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>[170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170]
[280, 280, 280, 280, 280, 280, 280, 280, 280, 280, 280, 280, 280, 280]
[320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320]
</code></pre></div>

<h3 id="exercise-2-call-knapsack-with-a-modified-list-of-widths">ðŸŽ’ Exercise 2: call knapsack with a modified list of widths<a class="headerlink" href="#exercise-2-call-knapsack-with-a-modified-list-of-widths" title="Permanent link">&para;</a></h3>
<p>In the above, we created new lists that properly signify the maximum number of units we could fit into the stock width. It is this list of items that we wish to feed into our knapsack problem. Rewrite our call to the knapsack problem below</p>
<div class="codehilite"><pre><span></span><code><span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">320</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">widths</span><span class="p">:</span>
    <span class="n">new</span> <span class="o">+=</span> <span class="p">[</span><span class="n">w</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">W</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>
<span class="n">widths</span> <span class="o">=</span> <span class="n">new</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">widths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>
<span class="n">pattern</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>4000





Counter({170: 12, 280: 7})
</code></pre></div>

<h3 id="exercise-3-report-the-loss">ðŸŽ’ Exercise 3: report the loss<a class="headerlink" href="#exercise-3-report-the-loss" title="Permanent link">&para;</a></h3>
<p>As a last adjustment, we want to think of the loss from a pattern, not the total number of millimeters used. Calculate the loss</p>
<div class="codehilite"><pre><span></span><code><span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">320</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">widths</span><span class="p">:</span>
    <span class="n">new</span> <span class="o">+=</span> <span class="p">[</span><span class="n">w</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">W</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>
<span class="n">widths</span> <span class="o">=</span> <span class="n">new</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">best</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">widths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>
<span class="n">pattern</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Loss: 0





Counter({170: 12, 280: 7})
</code></pre></div>

<h2 id="12-why-good-but-not-best">1.2: Why good but not best?<a class="headerlink" href="#12-why-good-but-not-best" title="Permanent link">&para;</a></h2>
<p>The shortcoming of the knapsack problem is that while it is able to find the best possible configuration to maximize the value of a knapsack, it does not consider constraints around items we <em>must</em> include. That is, when we create a schedule for our stock cutter, it is necessary that we deliver <em>all</em> orders within a reasonable time. </p>
<p>To over come this hurdle, we combine results from the knapsack problem (and any other pattern generative algorithm we would like to include) with a linear opimization task. We will cover the linear optimization task in a later notebook. Just know for now that we are still working on creating candidate patterns.</p>
<h3 id="121-find-all-unique-combinations-of-slit-widths">1.2.1 Find all unique combinations of slit widths<a class="headerlink" href="#121-find-all-unique-combinations-of-slit-widths" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">320</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">widths</span><span class="p">:</span>
    <span class="n">new</span> <span class="o">+=</span> <span class="p">[</span><span class="n">w</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">W</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>
<span class="n">widths</span> <span class="o">=</span> <span class="n">new</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">best</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">widths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Loss: 0
Counter({170: 12, 280: 7})
</code></pre></div>

<h3 id="exercise-4-permutate-the-list-of-unique-widths">ðŸŽ’ Exercise 4: permutate the list of unique widths<a class="headerlink" href="#exercise-4-permutate-the-list-of-unique-widths" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">320</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">max_unique_layouts</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">seed_patterns</span><span class="p">(</span><span class="n">_widths</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">max_unique_layouts</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">current_max</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_unique_layouts</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">pre_sacks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">_widths</span><span class="p">,</span> <span class="n">current_max</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">widths</span> <span class="ow">in</span> <span class="n">pre_sacks</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">widths</span><span class="p">:</span>
                <span class="n">new</span> <span class="o">+=</span> <span class="p">[</span><span class="n">w</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">W</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>
            <span class="n">widths</span> <span class="o">=</span> <span class="n">new</span>

            <span class="n">t</span> <span class="o">=</span> <span class="n">initt</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
            <span class="n">best</span> <span class="o">=</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">best</span>
            <span class="n">sack</span> <span class="o">=</span> <span class="n">reconstruct</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">widths</span><span class="p">),</span> <span class="n">W</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">widths</span><span class="p">)</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">widths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sack</span><span class="p">)])</span>
            <span class="n">patterns</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pattern</span><span class="p">,</span> <span class="n">loss</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">patterns</span>
</code></pre></div>

<p>Call your function</p>
<div class="codehilite"><pre><span></span><code><span class="n">seed_patterns</span><span class="p">(</span><span class="n">_widths</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>[[Counter({170: 23}), 90],
 [Counter({280: 14}), 80],
 [Counter({320: 12}), 160],
 [Counter({170: 12, 280: 7}), 0],
 [Counter({170: 16, 320: 4}), 0],
 [Counter({280: 12, 320: 2}), 0],
 [Counter({170: 12, 280: 7}), 0]]
</code></pre></div>

<p>For giggles, check the speed of your function using <code>%%timeit</code></p>
<div class="codehilite"><pre><span></span><code><span class="o">%%</span><span class="n">timeit</span>
<span class="n">patterns</span> <span class="o">=</span> <span class="n">seed_patterns</span><span class="p">(</span><span class="n">_widths</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>38 ms Â± 1.22 ms per loop (mean Â± std. dev. of 7 runs, 10 loops each)
</code></pre></div>

<h3 id="122-more-permutations">1.2.2 More permutations<a class="headerlink" href="#122-more-permutations" title="Permanent link">&para;</a></h3>
<p>This is grand, but notice there are additional patterns that may be useful for our stock cutting problem.</p>
<p>We were able to find:</p>
<p><code>[Counter({280: 12, 320: 2}), 0],</code></p>
<p>but notice how:</p>
<p><code>[Counter({320: 9, 280: 4}), 0]</code></p>
<p>is also a valid solution to fitting the two slit widths on stock. And in fact, the second solution may be one we need to produce our orders in as few stock rolls as possible. We'll come back to this question later on.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../SOLN_P1_Stock_Cutting/" class="md-footer__link md-footer__link--prev" aria-label="Previous: The Knapsack Problem" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              The Knapsack Problem
            </div>
          </div>
        </a>
      
      
        
        <a href="../SOLN_P3_Stock_Cutting/" class="md-footer__link md-footer__link--next" aria-label="Next: The Column Generation Method" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              The Column Generation Method
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.289a2a4b.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>